Заметки о работе с ОС MACOS
=============================

# Оглавление

1. <h3>[Настройка системы](#Настройка-системы)</h3>

    - [Отключение Dashboard](#Отключение-Dashboard)
    - [Отключение автоматического изменения порядка рабочих столов](#Отключение-автоматического-изменения-порядка-рабочих-столов)
    - [Расширение возможностей finder](#Расширение-возможностей-finder)
    - [Изменение значения TTL](#Изменение-значения-TTL)
    
2. <h3>[Установка/удаление программ](#Установка/удаление-программ)</h3>

    - <h4>[Brew](#Brew)</h4>
    
        - [Установка brew](#Установка-brew)
        - [Установка пакетов brew](#Установка-пакетов-brew)
        - [Удаление пакетов brew](#Удаление-пакетов-brew)
        - [Репозитори brew](#Репозитори-brew)
        - [Кэш brew](#Кэш-brew)
        - [Смена используемой версии пакета](#Смена-используемой-версии-пакета)
        - [Запуск и остановка фоновых служб brew](#Запуск-и-остановка-фоновых-служб-brew)
        - [Установка заранее скомпилированных программ](#Установка-заранее-скомпилированных-программ)
        
    - <h4>[PGK](#PGK)</h4>
    
        - [Удаление pkg](#Удаление-pkg)
        
    - <h4>[Python](#Python)</h4>
    
        - [Установка PyQt4](#Установка-PyQt4)
        - [Установка lxml](#Установка-lxml)
        - [Установка mpi4py](#Установка-mpi4py)
        - [Установка numpy](#Установка-numpy)


<a name='Настройка-системы'></a>
## Настройка системы


<a name='Отключение-Dashboard'></a>
### Отключение Dashboard

Для отключение Dashboard необходимо в консоли выполнить следующие команды

```bash
defaults write com.apple.dashboard mcx-disabled -boolean YES
killall Dock
```

Если вы передумали, включить Dashboard можно следующей командой

```bash
defaults write com.apple.dashboard mcx-disabled -boolean NO
```


<a name='Отключение-автоматического-изменения-порядка-рабочих-столов'></a>
### Отключение автоматического изменения порядка рабочих столов

В macos есть фукнция, которая автоматически меняет порядок созданных рабочих 
столов. Упорядочивает она их по частоте использования. Такое поведение не 
всегда удобно, а иногда вообще доставляет сильный дискомфорт.

К счастью эту "супер крутую" фичу можно отключить. Для этого:

- откройте `Системные настройки`
- выберите пункт `Mission Control`
- снимите галочку с `Автоматически использовать последние расположение пространств`


<a name='Расширение-возможностей-finder'></a>
### Расширение возможностей finder

Для того, чтобы расширить возможности finder можно воспользоваться утилитой
[XtraFinder](https://www.trankynam.com/xtrafinder/). 

Некоторые из ее возможностей:

- добавление в контекстное меню кнопки "вырезать"
- делает возможным отобразить скрытые файлы и папки
- и т.д. и т.п.

К минусам можно отнести то, что приложение по сути пачит оригинальный finder и
из-за этого устанавливать его проблематично.


<a name='Изменение-значения-TTL'></a>
### Изменение значения TTL

Time to live (TTL) — число итераций или переходов, за который набор данных 
(пакет) может существовать до своего исчезновения.

Есть 2 способа изменить значение TTL:

1. Значение TTL меняется на ограниченое время. После перезагрузки
системы будет востановлено значение по умолчанию.

   ```bash
   sudo sysctl -w net.inet.ip.ttl=<нужное значение ttl>
   ```
   
2. Установка постоянного значения TTL делается следующим образом:
    
    - создаем файл `/etc/sysctl.conf`
    - добавляем в него строку `net.inet.ip.ttl=<нужное значение ttl>`



<a name='Установка/удаление-программ'></a>
## Установка/удаление программ


<a name='Brew'></a>
### Brew

<a name='Установка-brew'></a>
#### Установка brew

Для того, чтобы установить brew вам необходимо сначала установить 
`Инструменты разработчика xcode`. После того как это сделано, можно приступить 
к установке самого brew, он ставится 1 просто командой:

```bash
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
```

Полезные ссылки:
- http://dghubble.com/blog/posts/homebrew-os-x-package-management/

<a name='Установка-пакетов-brew'></a>
#### Установка пакетов brew

Для того, чтобы установить пакет вам нужно выполнить 1 простую команду:

```bash
brew install <FORMULA>
```

FORMULA - это название пакета, который будет установлен.

**Установка конкретной вресии**

При помощи команды выше будет установлена самая последняя версия приложения.
Если вам необходимо установить опредленную версию, то необходимо будет сделать 
немного больше телодвижений:

- заходим в репозиторий и ищем в Pull requests коммит с нужной нам версией
программы и переходим к нему
- открываем вкладку commits
- переходим к коду этого коммита
- нажимаем view, чтобы посмотреть код этого коммита
- теперь переходим в режим просмотра кода raw
- копируем ссылку из адресной строки и подставляем в команду
    ```bash
    brew install https://raw.github.com/dsr/homebrew/9b22d42f50fcbc5e52c764448b3ac002bc153bd7/Library/Formula/python3.rb
    ``` 
Таким способом можно поставить любую версию интресующей вас программы.

Ссылки на дополнительную информацию:

- https://github.com/Homebrew/homebrew/blob/master/share/doc/homebrew/Tips-N'-Tricks.md
- http://effectif.com/mac-os-x/installing-specific-version-of-homebrew-formula (инф. старая)


<a name='Удаление-пакетов-brew'></a>
#### Удаление пакетов brew

Удаление пакетов установленных при помощи brew производится командой:

```bash
brew rm <FORMULA>
```

Для того, чтобы после подчистить не используемые более зависимости, 
нужно выполнить:

```bash
brew rm $(join <(brew leaves) <(brew deps FORMULA))
```

Пояснения:

- `FORMULA` - название пакета у которого необходимо найти неиспользуемые 
   зависимости
- `brew leaves` - выводит все пакеты, которые не зависят от других пакетов
- `brew deps` - выводит пакеты, от которых зависит данный пакет

Эта команда удалит пакеты, которые зависят от удаляемого пакета и, которые не 
зависят больше ни от каких других пакетов. Так как бывает, что установленные 
зависимости ссылаются друг на друга, получается, что с помощью этой команды 
нельзя удалить все не нужные зависимости удаляемого пакета.

Лучше всего записывать, какой пакет установил какие зависимости и потом в 
ручную удалять весь его мусор.

Ссылки которые могут помочь:
- http://oryband.com/removing-homebrew-packages-with-dependencies/

<a name='Репозитори-brew'></a>
#### Репозитори brew

Реппозитории в brew называеются tap.

Для того, чтобы добавить новый репозиторий можно пользоваться командой:

```bash
brew tap <REPO>
```

Список нужных реппозиториев:

- homebrew/boneyard
- homebrew/dupes
- homebrew/versions
- homebrew/x11


<a name='Кэш-brew'></a>
#### Кэш brew

Для того, чтобы получить путь к папке, где brew хранит исходные коды 
используемые для сборки приложения нужно выполнить в консоли:

```bash
brew --cache
```

<a name='Смена-используемой-версии-пакета'></a>
#### Смена используемой версии пакета

Brew позволяет вам установить одновременно несколько версий одного приложения, 
но по умолчанию у вас будет вызываться последняя установленная версия.
Для того, чтобы переключиться на предыдущую версию необходимо использовать 
команду switch.

Общий синтаксис команды

```bash
brew switch <FORMULA> <VERSION>
```

Пример установки python 3.5.1 как версии используемой по умолчанию 

```bash
brew switch python3 3.5.1
```


<a name='Запуск-и-остановка-фоновых-служб-brew'></a>
#### Запуск и остановка фоновых служб brew

https://robots.thoughtbot.com/starting-and-stopping-background-services-with-homebrew


<a name='Установка-заранее-скомпилированных-программ'></a>
#### Установка заранее скомпилированных программ

brew — «менеджер недостающих пакетов для macOS», как его называет создатель. 
Изначально он предназначается для компиляции приложений из исходных кодов. Но 
brew умеет не только это. Вместе с дополнением homebrew-cask он способен 
устанавливать приложения из «Терминала».

Для этого необходимо добавить в Homebrew реппозиторий cask:

```
brew tap caskroom/cask
```

После этого программы можно устанавливать следующим образом:

```
brew cask install docker google-chrome
```

Для удаления приложения необходимо ввести команду:

```
brew cask uninstall docker
```

<a name='PGK'></a>
### PGK

<a name='Удаление-pkg'></a>
#### Удаление pkg

1. Выведем список всех pkg в системе

    ```bash
    pkgutil --pkgs
    ```

2. Выбираем pkg, который нужно удалить и копируем его имя и вставляем его в команду

    ```bash
    pkgutil --forget <скопированное имя>
    ```
    
3. Перетащить app файл в корзину (если он остался)


<a name='Python'></a>
### Python

<a name='Установка-PyQt4'></a>
#### Установка PyQt4

```bash
brew install pyqt --with-python3
```

<a name='Установка-lxml'></a>
#### Установка lxml

Для того, чтобы установить библиотеку lxml нужно сначала установить сишную 
реализацию этой либы

```bash
brew install libxml2 
brew install libxslt
 
brew link libxml2 --force 
brew link libxslt --force
```

Теперь можно устанавливать обертку для python

```bash
pip3 install lxml
```

Теперь можно выполнить

```bash
brew unlink libxml2 
brew unlink libxslt
```

<a name='Установка-mpi4py'></a>
#### Установка mpi4py

```bash
brew install mpich
pip3 install mpi4py
```

<a name='Установка-numpy'></a>
#### Установка numpy

```bash
brew install homebrew/python/numpy --with-python3
```

